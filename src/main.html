<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Brew Status - Dashboard</title>
    <link rel="stylesheet" href="./main.css" />
  </head>
  <body>
    <div class="app">
      <header class="titlebar" id="custom-titlebar" data-tauri-drag-region>
        <div class="titlebar-left" data-tauri-drag-region>
          <span class="titlebar-title" data-tauri-drag-region>Brew Status</span>
          <span class="titlebar-profile" id="titlebar-profile" data-tauri-drag-region></span>
        </div>
        <div class="titlebar-controls" id="custom-titlebar-controls">
          <button class="titlebar-btn minimize" id="btn-minimize">&#x2013;</button>
          <button class="titlebar-btn close" id="btn-close">&#x2715;</button>
        </div>
      </header>

      <main class="dashboard">
        <!-- Usage Limits -->
        <section class="panel limits-panel">
          <div class="limits-panel-header">
            <h2>Usage Limits</h2>
            <button class="refresh-btn" id="dashboard-refresh-limits" title="Refresh">&#x21bb;</button>
          </div>
          <div class="dashboard-limits" id="dashboard-limits">
            <div class="limits-loading">Loading limits...</div>
          </div>
        </section>

        <!-- Top row: 2 columns -->
        <section class="panel token-panel">
          <h2>Token Usage</h2>
          <div id="token-usage-content"></div>
        </section>

        <section class="panel session-panel">
          <h2>Session Stats</h2>
          <div class="session-stats-grid" id="session-stats"></div>
          <h3>Hourly Activity</h3>
          <canvas id="heatmap-canvas" height="50"></canvas>
        </section>

        <!-- Full width: 7-day chart -->
        <section class="panel chart-panel">
          <div class="chart-header">
            <h2>7-Day Activity</h2>
            <div class="chart-toggles">
              <button class="toggle-btn active" data-metric="tokens">Tokens</button>
              <button class="toggle-btn" data-metric="messages">Messages</button>
              <button class="toggle-btn" data-metric="toolCalls">Tool Calls</button>
            </div>
          </div>
          <canvas id="activity-chart" height="200"></canvas>
        </section>

        <!-- Full width: Recent history -->
        <section class="panel history-panel">
          <h2>Recent History</h2>
          <div class="history-list" id="history-list"></div>
        </section>

        <!-- About -->
        <section class="panel about-panel">
          <h2>About</h2>
          <div class="about-row">
            <span class="about-label">Brew Status <span id="about-version"></span></span>
            <div class="about-row-right">
              <span class="about-status" id="about-status"></span>
              <button class="about-btn" id="about-check-update">Check for Updates</button>
            </div>
          </div>
          <span class="about-note">Checks automatically every 24 hours</span>
        </section>
      </main>
    </div>

    <script type="module" src="./main.ts"></script>
  </body>
</html>
